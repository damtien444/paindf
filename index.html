<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video and Image Selector</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .media-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .media-wrapper {
            flex: 1;
            margin-right: 20px;
            text-align: center;
        }

        .media-wrapper:last-child {
            margin-right: 0;
        }

        video, img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .control-group {
            flex: 1;
            margin-right: 10px;
        }

        .control-group:last-child {
            margin-right: 0;
        }

        h3 {
            margin-top: 0;
            margin-bottom: 10px;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
        }

        label {
            margin-bottom: 5px;
        }

        .error-message {
            color: red;
            font-style: italic;
            text-align: center;
        }

        .mute-toggle {
            display: block;
            margin: 10px auto;
            padding: 8px 16px;
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .mute-toggle:hover {
            background-color: #d32f2f;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="media-container">
            <div class="media-wrapper">
                <h4>Stimuli Video</h4>
                <video id="stimuliVideo" controls autoplay muted loop>
                    <source src="" type="video/mp4">
                    <source src="" type="video/webm">
                    Your browser does not support the video tag.
                </video>
                <p class="error-message" id="stimuliErrorMessage" style="display:none;">Error: Stimuli video could not be loaded. Please check the file path and format.</p>
            </div>
            <div class="media-wrapper">
                <h4>Selected Video</h4>
                <video id="videoPlayer" controls autoplay muted loop>
                    <source src="" type="video/mp4">
                    <source src="" type="video/webm">
                    Your browser does not support the video tag.
                </video>
                <p class="error-message" id="errorMessage" style="display:none;">Error: Video could not be loaded. Please check the file path and format.</p>
                <button class="mute-toggle" onclick="toggleMute()">Unmute</button>
            </div>
            <div class="media-wrapper">
                <h4>Movement area</h4>
                <img id="imageDisplay" src="" alt="Image Preview" />
            </div>
        </div>
        <div class="controls">
            <div class="control-group">
                <h3>Stimuli (x)</h3>
                <div class="radio-group" id="stimuliGroup"></div>
            </div>
            <div class="control-group">
                <h3>Expressiveness (y)</h3>
                <div class="radio-group" id="expressivenessGroup"></div>
            </div>
            <div class="control-group">
                <h3>Emotion (z)</h3>
                <div class="radio-group" id="emotionGroup"></div>
            </div>
        </div>
    </div>

    <script>
        const videoDirectory = 'demo_video/'; // Adjust this if your videos are in a different directory
        const stimuliRange = [1, 2, 3, 4];
        const expressivenessRange = [5, 6, 7, 8, 9, 10, 11];
        const emotionMap = {
            0: 'Anger',
            1: 'Contempt',
            2: 'Disgust',
            3: 'Fear',
            4: 'Happiness',
            5: 'Neutral',
            6: 'Sadness',
            7: 'Surprise'
        };
        let currentVideo = { x: 1, y: 5, z: 0 };

        function createRadioButtons(groupId, range, parameter, useLabels = false) {
            const group = document.getElementById(groupId);
            range.forEach(value => {
                const label = document.createElement('label');
                const displayValue = useLabels ? emotionMap[value] : value;
                label.innerHTML = `
                    <input type="radio" name="${groupId}" value="${value}" 
                           ${value === currentVideo[parameter] ? 'checked' : ''}
                           onchange="updateVideo('${parameter}', ${value})">
                    ${displayValue}
                `;
                group.appendChild(label);
            });
        }

        function updateVideo(parameter, value) {
            currentVideo[parameter] = value;
            loadMedia();
        }

        function loadMedia() {
            const videoPlayer = document.getElementById('videoPlayer');
            const stimuliVideo = document.getElementById('stimuliVideo');
            const imageDisplay = document.getElementById('imageDisplay');
            const errorMessage = document.getElementById('errorMessage');
            const stimuliErrorMessage = document.getElementById('stimuliErrorMessage');

            const videoFilename = `stimuli_${currentVideo.x}_expressiveness_${currentVideo.y}_emotion_${currentVideo.z}/0_reencode.mp4`;
            const stimuliFilename = `stimuli_${currentVideo.x}.mp4`;
            const imageFilename = `stimuli_${currentVideo.x}_expressiveness_${currentVideo.y}_emotion_${currentVideo.z}.png`;

            const videoSrc = videoDirectory + videoFilename;
            const stimuliSrc = videoDirectory + stimuliFilename;
            const imageSrc = videoDirectory + imageFilename;

            videoPlayer.src = videoSrc;
            stimuliVideo.src = stimuliSrc;
            imageDisplay.src = imageSrc;

            videoPlayer.load();
            stimuliVideo.load();

            videoPlayer.onloadeddata = function () {
                errorMessage.style.display = 'none';
            };

            videoPlayer.onerror = function () {
                errorMessage.style.display = 'block';
            };

            stimuliVideo.onloadeddata = function () {
                stimuliErrorMessage.style.display = 'none';
            };

            stimuliVideo.onerror = function () {
                stimuliErrorMessage.style.display = 'block';
            };
        }

        function toggleMute() {
            const videoPlayer = document.getElementById('videoPlayer');
            const stimuliVideo = document.getElementById('stimuliVideo');
            const muteToggle = document.querySelector('.mute-toggle');
            const isMuted = !videoPlayer.muted;

            videoPlayer.muted = isMuted;
            stimuliVideo.muted = isMuted;
            muteToggle.textContent = isMuted ? 'Unmute' : 'Mute';
        }

        // Initialize radio buttons
        createRadioButtons('stimuliGroup', stimuliRange, 'x');
        createRadioButtons('expressivenessGroup', expressivenessRange, 'y');
        createRadioButtons('emotionGroup', Object.keys(emotionMap), 'z', true);

        // Load initial media
        loadMedia();
    </script>
</body>

</html>
